<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H√†nh Tr√¨nh Nh√¢n Quy·ªÅn</title>
    
    <link rel="stylesheet" href="css/timeline_labels.css?v=2">

    <!-- Dependencies from Code2.html -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@100;300;400;700;900&display=swap');
        
        body { margin: 0; overflow: hidden; background-color: #000; font-family: 'Montserrat', sans-serif; color: white; }
        #canvas-container { position: fixed; inset: 0; z-index: 1; }
        #ui-layer { position: relative; z-index: 10; pointer-events: none; height: 100vh; display: flex; flex-direction: column; justify-content: space-between; padding: 2rem; }
        
        /* Gestures UI Overrides for functionality */
        .input_video { display: none; } /* Hide raw video */
        .output_canvas { 
            width: 100%; height: 100%; 
            border-radius: 20px; 
            transform: scaleX(-1); /* Mirror effect */
        }
        
        /* Camera Monitor specific style */
        #video-monitor {
            position: fixed; top: 1.5rem; right: 1.5rem; width: 180px; height: 135px; 
            border-radius: 20px; z-index: 100; 
            border: 3px solid rgba(255,255,255,0.3); 
            background: #000;
            overflow: hidden;
            opacity: 0.9;
        }

        /* STATUS TEXT Overlay inside Monitor */
        #status-text {
            position: absolute; bottom: 5px; left: 0; width: 100%;
            text-align: center; font-size: 10px; font-weight: bold;
            color: #00ff00; text-shadow: 0 1px 2px black;
            z-index: 102;
        }
        
        #gesture-progress-container {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 4px;
            background: rgba(255,255,255,0.2);
            z-index: 102;
        }
        #gesture-progress-bar {
            height: 100%; background: #4ade80; width: 0%;
        }

        /* Neural Gestures Panel - Logic ·∫®n/Hi·ªán from Code2 */
        #gesture-note {
            position: fixed; bottom: 2rem; left: 2rem; z-index: 150;
            background: rgba(255,255,255,0.03); backdrop-filter: blur(40px);
            padding: 1.5rem; width: 340px; border-radius: 30px; pointer-events: auto;
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        #gesture-note.hidden-panel { opacity: 0; transform: translateY(50px); pointer-events: none; }

        .gk { display: flex; align-items: center; gap: 12px; font-size: 0.7rem; opacity: 0.3; transition: all 0.4s ease; text-transform: uppercase; margin-bottom: 6px; font-weight: 700; }
        .gk.active { opacity: 1; color: #4ade80; transform: scale(1.05); }
        .gk-icon { width: 24px; height: 24px; background: rgba(255,255,255,0.1); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }

        /* Info Panel V√¥ c·ª±c (Code2) */
        .info-panel { text-align: center; width: 100%; transition: all 1s ease; opacity: 0; transform: translateY(30px); }
        .info-panel.visible { opacity: 1; transform: translateY(0); }
        .glow-text { text-shadow: 0 0 70px rgba(255,255,255,0.5); letter-spacing: -3px; }

        .rights-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6rem; margin-top: 5rem; text-align: left; }
        
        #main-header { transition: opacity 1s ease, transform 1s ease; }
        .header-hidden { opacity: 0; transform: translateY(-50px); pointer-events: none; }

        /* Slide Navigation Bar (Content Mode) */
        #slide-nav-bar {
            position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%);
            display: flex; gap: 1rem; padding: 10px 20px;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(10px);
            border-radius: 50px; border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.5s ease; opacity: 0; pointer-events: none;
            z-index: 200;
        }
        #slide-nav-bar.visible-bar { opacity: 1; pointer-events: auto; }
        .slide-marker {
            width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;
            border-radius: 50%; border: 1px solid rgba(255,255,255,0.2);
            font-size: 12px; cursor: pointer; transition: all 0.3s ease;
            color: rgba(255,255,255,0.5); font-weight: bold;
        }
        .slide-marker.active {
            background: #fff; color: #000; border-color: #fff; transform: scale(1.2);
        }
        .slide-marker:hover { border-color: #fff; color: #fff; }

        /* Slide Content Backdrop & Overlay */
        #content-backdrop {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85); /* Darker backdrop */
            backdrop-filter: blur(8px);
            opacity: 0; transition: opacity 0.35s ease; pointer-events: none;
            z-index: 180;
        }
        #content-backdrop.visible { opacity: 1; pointer-events: auto; }

        /* New Large Background Image Layer */
        #slide-bg {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95);
            width: 90vw; height: 85vh;
            background-size: 100% 100%; background-repeat: no-repeat; background-position: center;
            border-radius: 24px;
            z-index: 185; opacity: 0; transition: all 0.6s cubic-bezier(0.22, 1, 0.36, 1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
            filter: brightness(0.6) blur(4px);
        }
        #slide-bg.visible { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        #slide-bg::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(90deg, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.7) 45%, rgba(0,0,0,0.2) 100%);
            border-radius: 24px;
        }

        #slide-info-overlay {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 85vw; height: 80vh; max-width: none; max-height: none; overflow: hidden;
            display: flex; flex-direction: row; justify-content: center; align-items: center;
            text-align: left; pointer-events: none; /* Let clicks pass to bg if needed, or backdrop */
            opacity: 0; transition: opacity 0.4s ease 0.1s;
            z-index: 190; padding: 0 5vw;
            background: transparent; box-shadow: none;
        }
        #slide-info-overlay.visible-overlay { opacity: 1; pointer-events: auto; }
        
        #slide-desc {
            font-size: 1.05rem; font-weight: 400; line-height: 1.6; color: #ffffff;
            margin: 0; padding: 0; text-shadow: none; max-width: 600px; /* Limit text width for reading */
        }
        
        /* Ensure start button is always clickable and visible */
        #start-btn {
            position: fixed !important;
            bottom: 3rem !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            z-index: 220 !important;
            pointer-events: auto !important;
        }
        /* Bottom Hint */
        #slide-hint {
            position: fixed; bottom: 6rem; left: 0; width: 100%;
            text-align: center; font-size: 0.75rem; color: rgba(255,255,255,0.55);
            pointer-events: none; z-index: 195;
            opacity: 0; transition: opacity 0.35s ease;
        }
        #slide-hint.visible { opacity: 1; }
    </style>
</head>
<body>

    <!-- 3D Canvas Background -->
    <div id="canvas-container"></div>

    <!-- Background Music -->
    <audio id="bg-music" loop>
        <source src="audio/patriotic-epic.mp3" type="audio/mpeg">
    </audio>

    <!-- Music Control UI -->
    <div id="music-control" onclick="toggleMusic()" class="fixed top-6 left-6 z-[200] cursor-pointer opacity-50 hover:opacity-100 transition-all duration-300 group">
        <div class="flex items-center gap-3 bg-black/50 backdrop-blur-md p-3 pr-5 rounded-full border border-white/10 hover:border-white/30 hover:bg-black/80">
            <div id="music-icon-container" class="w-8 h-8 flex items-center justify-center rounded-full bg-white/10 group-hover:bg-white/20 transition-colors">
                <!-- Sound Off (Default) -->
                <svg id="icon-sound-off" class="w-4 h-4 text-white/50" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
                </svg>
                <!-- Sound On -->
                <svg id="icon-sound-on" class="w-4 h-4 text-white hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 14.142M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                </svg>
            </div>
            <span id="music-text" class="text-[10px] font-bold uppercase tracking-[0.2em] text-white/50 group-hover:text-white transition-colors">B·∫≠t Nh·∫°c</span>
        </div>
    </div>

    <!-- Small UI: Camera Monitor + Status -->
    <div id="video-monitor" class="webcam-container">
        <video class="input_video" autoplay playsinline></video>
        <!-- The canvas output from gestures.js goes here -->
        <canvas class="output_canvas" width="640" height="480"></canvas>
        <div id="status-text">ƒêang ch·ªù 2 tay...</div>
        <div id="gesture-progress-container">
            <div id="gesture-progress-bar"></div>
        </div>
    </div>

    <!-- Menu Neural Gestures (Code2 Design) -->
    <div id="gesture-note">
        <div class="text-[10px] font-black opacity-30 mb-5 tracking-[0.4em] uppercase">Neural Gestures (Hold 2s)</div>
        <div class="gk" id="gk-select"><div class="gk-icon">‚úä+üëÜ</div> 1 N·∫Øm + 1-5 Ng√≥n: Era 1-5</div>
        <div class="gk" id="gk-communist"><div class="gk-icon">üññ</div> 2 Tay T·ªïng 6 Ng√≥n: Era 6</div>
        <div class="gk" id="gk-timeline"><div class="gk-icon">‚úä‚úä</div> 2 Tay N·∫Øm: Timeline</div>
        <div class="gk" id="gk-reset"><div class="gk-icon">üñêüñê</div> 2 Tay M·ªü: H·ªón Mang</div>
        <div class="mt-4 text-[8px] font-black text-emerald-400/50 uppercase italic">H·ªá th·ªëng y√™u c·∫ßu 2 b√†n tay</div>
    </div>

    <!-- UI Overlay (Code2 Structure) -->
    <div id="ui-layer">
        <div class="flex flex-col items-center pt-16" id="main-header">
            <h1 class="text-7xl font-black uppercase tracking-tighter glow-text leading-none" id="main-title">Nh√¢n Quy·ªÅn</h1>
            <p class="text-[14px] tracking-[1.4em] uppercase opacity-30 mt-6">D√≤ng ch·∫£y nh·∫≠n th·ª©c l·ªãch s·ª≠</p>
        </div>

        <div class="flex justify-center items-center flex-1">
            <div id="era-panel" class="info-panel pointer-events-none">
                <h2 id="era-title" class="text-7xl md:text-8xl font-black mb-4 glow-text uppercase italic tracking-tighter leading-none"></h2>
                <div class="bg-white/5 backdrop-blur-xl p-6 rounded-3xl max-w-6xl mx-auto border border-white/10 shadow-[0_8px_32px_0_rgba(31,38,135,0.37)]">
                    <p id="era-desc" class="text-lg font-light text-white/60 mb-8 italic"></p>
                    
                    <div class="rights-grid px-8 gap-8 mt-2">
                        <div class="relative">
                            <h4 class="text-[11px] font-black text-blue-400 uppercase tracking-[0.4em] mb-4 border-l-2 border-blue-400 pl-4">N·ªôi h√†m Quy·ªÅn</h4>
                            <p id="rights-core" class="text-[16px] leading-relaxed text-white/95 font-light"></p>
                        </div>
                        <div class="relative">
                            <h4 class="text-[11px] font-black text-emerald-400 uppercase tracking-[0.4em] mb-4 border-l-2 border-emerald-400 pl-4">B·∫£n ch·∫•t x√£ h·ªôi</h4>
                            <p id="rights-social" class="text-[16px] leading-relaxed text-white/80 font-light"></p>
                        </div>
                    </div>

                    <div class="mt-8 flex justify-center gap-16 text-[10px] uppercase tracking-[0.4em] opacity-40 font-black">
                        <div>S·ªü h·ªØu: <span id="meta-property" class="text-white"></span></div>
                        <div>T·ª± do: <span id="meta-freedom" class="text-white"></span></div>
                        <div>B·∫£n ch·∫•t: <span id="meta-nature" class="text-white"></span></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex justify-center pb-12">
            <button id="start-btn" class="px-20 py-6 bg-white text-black font-black text-[13px] uppercase tracking-[0.6em] rounded-full pointer-events-auto hover:invert transition-all duration-1000 shadow-[0_0_100px_rgba(255,255,255,0.4)]">
                K√çCH HO·∫†T CAMERA
            </button>
        </div>

        <!-- Slide Navigation Bar -->
        <div id="slide-nav-bar"></div>
        
        <!-- Backdrop when showing slide content -->
        <div id="content-backdrop"></div>
        
        <!-- Large Background Image -->
        <div id="slide-bg"></div>

        <!-- Slide UI Text Overlay -->
        <div id="slide-info-overlay">
            <!-- This will be the main container for the two-column layout -->
        </div>
        
        <!-- Bottom Hint -->
        <div id="slide-hint">D√πng 1 ng√≥n ƒë·ªÉ t·ªõi, 2 ng√≥n ƒë·ªÉ l√πi. Gi∆° 8 ng√≥n ƒë·ªÉ tho√°t.</div>
    </div>

    <!-- Scripts -->
    <script src="js/particles.js"></script>
    <script src="js/gestures.js"></script>
    <script src="js/main.js"></script>
</body>
</html>